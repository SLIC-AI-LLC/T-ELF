
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TELF.factorization.NMFk: Non-negative Matrix Factorization with Automatic Model Determination &#8212; TELF 0.0.42 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=0ef7f92b"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'NMFk';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TELF.factorization.HNMFk: Hierarchical Non-negative Matrix Factorization with Automatic Model Determination" href="HNMFk.html" />
    <link rel="prev" title="Tensor Extraction of Latent Features (T-ELF)" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">TELF 0.0.42 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>TELF.factorization.NMFk:</strong> Non-negative Matrix Factorization with Automatic Model Determination</a></li>



<li class="toctree-l1"><a class="reference internal" href="HNMFk.html"><strong>TELF.factorization.HNMFk:</strong> Hierarchical Non-negative Matrix Factorization with Automatic Model Determination</a></li>


<li class="toctree-l1"><a class="reference internal" href="RESCALk.html"><strong>TELF.factorization.RESCALk:</strong> RESCAL with Automatic Model Determination</a></li>



<li class="toctree-l1"><a class="reference internal" href="TriNMFk.html"><strong>TELF.factorization.TriNMFk:</strong> NMFk with Automatic Determination of Latent Clusters and Patterns</a></li>



<li class="toctree-l1"><a class="reference internal" href="SymNMFk.html"><strong>TELF.factorization.SymNMFk:</strong> Symmetric Non-negative Matrix Factorization with Automatic Model Determination</a></li>


<li class="toctree-l1"><a class="reference internal" href="SPLIT.html"><strong>TELF.factorization.SPLIT:</strong> Joint NMFk factorization of multiple data via SPLIT</a></li>


<li class="toctree-l1"><a class="reference internal" href="SPLITTransfer.html"><strong>TELF.factorization.SPLITTransfer:</strong> Supervised transfer learning method via SPLIT and NMFk</a></li>


<li class="toctree-l1"><a class="reference internal" href="Beaver.html"><strong>TELF.pre_processing.Beaver:</strong> Fast matrix and tensor building tool</a></li>



<li class="toctree-l1"><a class="reference internal" href="Vulture.html"><strong>TELF.pre_processing.Vulture:</strong> Advanced text pre-processing and cleaning tool for NLP and text-mining</a></li>



<li class="toctree-l1"><a class="reference internal" href="Cheetah.html"><strong>TELF.applications.Cheetah:</strong> Advanced search by keywords and phrases</a></li>


<li class="toctree-l1"><a class="reference internal" href="Orca.html"><strong>TELF.pre_processing.Orca:</strong> Duplicate author detector for text mining and information retrival</a></li>


<li class="toctree-l1"><a class="reference internal" href="Wolf.html"><strong>TELF.post_processing.Wolf:</strong> Graph centrality and ranking tool</a></li>


<li class="toctree-l1"><a class="reference internal" href="iPenguin.html"><strong>TELF.pre_processing.iPenguin:</strong> Online information retrieval tool for Scopus, SemanticScholar, and OSTI</a></li>






<li class="toctree-l1"><a class="reference internal" href="Penguin.html"><strong>TELF.applications.Penguin:</strong>  Text storage tool</a></li>


<li class="toctree-l1"><a class="reference internal" href="Bunny.html"><strong>TELF.applications.Bunny:</strong>   Dataset generation tool for documents and their citations/references</a></li>




<li class="toctree-l1"><a class="reference internal" href="SeaLion.html"><strong>TELF.post_processing.SeaLion:</strong> Generic report generation tool</a></li>


<li class="toctree-l1"><a class="reference internal" href="Fox.html"><strong>TELF.post_processing.Fox:</strong> Report generation tool for text data from HNMFk using local LLMs</a></li>


<li class="toctree-l1"><a class="reference internal" href="ArcticFox.html"><strong>TELF.post_processing.ArcticFox:</strong> Report generation tool for text data from HNMFk using local LLMs</a></li>


<li class="toctree-l1"><a class="reference internal" href="Squirrel.html"><strong>TELF.pre_processing.Squirrel:</strong>   Dataset pruning tool</a></li>






<li class="toctree-l1 has-children"><a class="reference internal" href="modules.html">TELF</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="TELF.html">TELF package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="TELF.factorization.html">TELF.factorization package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="TELF.factorization.decompositions.html">TELF.factorization.decompositions package</a></li>
<li class="toctree-l4"><a class="reference internal" href="TELF.factorization.utilities.html">TELF.factorization.utilities package</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="TELF.pre_processing.html">TELF.pre_processing package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="TELF.pre_processing.Beaver.html">TELF.pre_processing.Beaver package</a></li>
<li class="toctree-l4"><a class="reference internal" href="TELF.pre_processing.Vulture.html">TELF.pre_processing.Vulture package</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/NMFk.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>TELF.factorization.NMFk: Non-negative Matrix Factorization with Automatic Model Determination</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>TELF.factorization.NMFk:</strong> Non-negative Matrix Factorization with Automatic Model Determination</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#available-functions">Available Functions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#module-TELF.factorization.NMFk">Module Contents</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#TELF.factorization.NMFk.NMFk"><code class="docutils literal notranslate"><span class="pre">NMFk</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#TELF.factorization.NMFk.NMFk.fit"><code class="docutils literal notranslate"><span class="pre">NMFk.fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="telf-factorization-nmfk-non-negative-matrix-factorization-with-automatic-model-determination">
<h1><strong>TELF.factorization.NMFk:</strong> Non-negative Matrix Factorization with Automatic Model Determination<a class="headerlink" href="#telf-factorization-nmfk-non-negative-matrix-factorization-with-automatic-model-determination" title="Link to this heading">#</a></h1>
<p>NMFk is a Non-negative Matrix Factorization module with the capability to do automatic model determination.</p>
</section>
<section id="example">
<h1>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h1>
<p>First generate synthetic data with pre-determined k. It can be either dense (<code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>) or sparse matrix (<code class="docutils literal notranslate"><span class="pre">scipy.sparse._csr.csr_matrix</span></code>). Here, we are using the provided scripts for matrix generation (located <a class="reference external" href="https://github.com/lanl/T-ELF/tree/main/scripts">here</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../../scripts/&quot;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">generate_X</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen_data</span><span class="p">,</span><span class="n">gen_data_sparse</span>

<span class="n">Xsp</span> <span class="o">=</span> <span class="n">gen_data_sparse</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">density</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">gen_data</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">])[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now we can factorize the given matrix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">TELF.factorization</span><span class="w"> </span><span class="kn">import</span> <span class="n">NMFk</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n_perturbs&quot;</span><span class="p">:</span><span class="mi">36</span><span class="p">,</span>
    <span class="s2">&quot;n_iters&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.015</span><span class="p">,</span>
    <span class="s2">&quot;n_jobs&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;init&quot;</span><span class="p">:</span><span class="s2">&quot;nnsvd&quot;</span><span class="p">,</span>
    <span class="s2">&quot;use_gpu&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;save_path&quot;</span><span class="p">:</span><span class="s2">&quot;../../results/&quot;</span><span class="p">,</span>
    <span class="s2">&quot;save_output&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;collect_output&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;predict_k&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;predict_k_method&quot;</span><span class="p">:</span><span class="s2">&quot;sill&quot;</span><span class="p">,</span>
    <span class="s2">&quot;verbose&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;nmf_verbose&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;transpose&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;sill_thresh&quot;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="s2">&quot;pruned&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;nmf_method&#39;</span><span class="p">:</span><span class="s1">&#39;nmf_kl_mu&#39;</span><span class="p">,</span>
    <span class="s2">&quot;calculate_error&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;predict_k&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;use_consensus_stopping&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;calculate_pac&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;perturb_type&quot;</span><span class="p">:</span><span class="s2">&quot;uniform&quot;</span>
<span class="p">}</span>
<span class="n">Ks</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Example_NMFk&quot;</span>
<span class="n">note</span> <span class="o">=</span> <span class="s2">&quot;This is an example run of NMFk&quot;</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">NMFk</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="p">,</span> <span class="n">note</span><span class="p">)</span>
</pre></div>
</div>
<p>Resulting plots showing the estimation of the matrix rank, or the number of latent factors can be found at <code class="docutils literal notranslate"><span class="pre">../../results/</span></code>.</p>
</section>
<section id="available-functions">
<h1>Available Functions<a class="headerlink" href="#available-functions" title="Link to this heading">#</a></h1>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">NMFk.__init__</span></code>([n_perturbs, n_iters, ...])</p></td>
<td><p>NMFk is a Non-negative Matrix Factorization module with the capability to do automatic model determination.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="TELF.factorization.html#TELF.factorization.NMFk.NMFk.fit" title="TELF.factorization.NMFk.NMFk.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NMFk.fit</span></code></a>(X, Ks[, name, note])</p></td>
<td><p>Factorize the input matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> for the each given K value in <code class="docutils literal notranslate"><span class="pre">Ks</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-TELF.factorization.NMFk">
<span id="module-contents"></span><h1>Module Contents<a class="headerlink" href="#module-TELF.factorization.NMFk" title="Link to this heading">#</a></h1>
<p>© 2022. Triad National Security, LLC. All rights reserved.
This program was produced under U.S. Government contract 89233218CNA000001 for Los Alamos
National Laboratory (LANL), which is operated by Triad National Security, LLC for the U.S.
Department of Energy/National Nuclear Security Administration. All rights in the program are
reserved by Triad National Security, LLC, and the U.S. Department of Energy/National Nuclear
Security Administration. The Government is granted for itself and others acting on its behalf a
nonexclusive, paid-up, irrevocable worldwide license in this material to reproduce, prepare
derivative works, distribute copies to the public, perform publicly and display publicly, and to permit
others to do so.</p>
<dl class="py class">
<dt class="sig sig-object py" id="TELF.factorization.NMFk.NMFk">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TELF.factorization.NMFk.</span></span><span class="sig-name descname"><span class="pre">NMFk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_perturbs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.015</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturb_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nnsvd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collect_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_k_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'WH_sill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmf_verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturb_verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sill_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmf_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmf_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nmf_fro_mu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clustering_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kmeans'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmf_obj_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clustering_obj_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pruned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturb_multiprocessing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consensus_mat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_consensus_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_pac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_plot_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simple_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_search_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_sill_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor_thresholding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor_thresholding_H_regression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor_thresholding_obj_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor_thresholding_H_regression_obj_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TELF/factorization/NMFk.html#NMFk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TELF.factorization.NMFk.NMFk" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>NMFk is a Non-negative Matrix Factorization module with the capability to do automatic model determination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_perturbs</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bootstrap operations, or random matrices generated around the original matrix. The default is 20.</p></li>
<li><p><strong>n_iters</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of NMF iterations. The default is 100.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em> or </em><em>tuple</em><em> of </em><em>two elements</em><em>, </em><em>optional</em>) – <p>Error amount for the random matrices generated around the original matrix. The default is 0.015.</p>
<p>The default when <code class="docutils literal notranslate"><span class="pre">perturb_type='bool'</span></code> or <code class="docutils literal notranslate"><span class="pre">perturb_type='boolean'</span></code> is (epsilon, epsilon).</p>
<p><code class="docutils literal notranslate"><span class="pre">epsilon</span></code> is used when <code class="docutils literal notranslate"><span class="pre">perturb_type='uniform'</span></code> or <code class="docutils literal notranslate"><span class="pre">perturb_type='bool'</span></code> or <code class="docutils literal notranslate"><span class="pre">perturb_type='boolean'</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">perturb_type='bool'</span></code> or <code class="docutils literal notranslate"><span class="pre">perturb_type='boolean'</span></code>, use <code class="docutils literal notranslate"><span class="pre">`epsilon=tuple()`</span></code> where</p>
<p>positive noise: flip 0s to 1s (additive noise), negative noise: flip 1s to 0s (subtractive noise).</p>
</div>
</p></li>
<li><p><strong>perturb_type</strong> – <p>Type of error sampling to perform for the bootstrap operation. The default is “uniform”.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">perturb_type='uniform'</span></code> will use uniform distribution for sampling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">perturb_type='poisson'</span></code> will use Poission distribution for sampling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">perturb_type='bool'</span></code> or <code class="docutils literal notranslate"><span class="pre">perturb_type='boolean'</span></code> will use Boolean perturbations.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>n_jobs<span class="classifier">int, optional</span></dt><dd><p>Number of parallel jobs. Use -1 to use all available resources. The default is 1.</p>
</dd>
<dt>n_nodes<span class="classifier">int, optional</span></dt><dd><p>Number of HPC nodes. The default is 1.</p>
</dd>
<dt>init<span class="classifier">str, optional</span></dt><dd><p>Initilization of matrices for NMF procedure. The default is “nnsvd”.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">init='nnsvd'</span></code> will use NNSVD for initilization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init='random'</span></code> will use random sampling for initilization.</p></li>
</ul>
</dd>
<dt>use_gpu<span class="classifier">bool, optional</span></dt><dd><p>If True, uses GPU for operations. The default is True.</p>
</dd>
<dt>save_path<span class="classifier">str, optional</span></dt><dd><p>Location to save output. The default is “”.</p>
</dd>
<dt>save_output<span class="classifier">bool, optional</span></dt><dd><p>If True, saves the resulting latent factors and plots. The default is True.</p>
</dd>
<dt>collect_output<span class="classifier">bool, optional</span></dt><dd><p>If True, collectes the resulting latent factors to be returned from <code class="docutils literal notranslate"><span class="pre">fit()</span></code> operation. The default is False.</p>
</dd>
<dt>predict_k<span class="classifier">bool, optional</span></dt><dd><p>If True, performs automatic prediction of the number of latent factors. The default is False.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even when <code class="docutils literal notranslate"><span class="pre">predict_k=False</span></code>, number of latent factors can be estimated using the figures saved in <code class="docutils literal notranslate"><span class="pre">save_path</span></code>.</p>
</div>
</dd>
<dt>predict_k_method<span class="classifier">str, optional</span></dt><dd><p>Method to use when performing automatic k prediction. Default is “WH_sill”.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">predict_k_method='pvalue'</span></code> will use L-Statistics with column-wise error for automatically estimating the number of latent factors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_k_method='WH_sill'</span></code> will use Silhouette scores from minimum of W and H latent factors for estimating the number of latent factors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_k_method='W_sill'</span></code> will use Silhouette scores from W latent factor for estimating the number of latent factors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_k_method='H_sill'</span></code> will use Silhouette scores from H latent factor for estimating the number of latent factors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">predict_k_method='sill'</span></code> will default to <code class="docutils literal notranslate"><span class="pre">predict_k_method='WH_sill'</span></code>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">predict_k_method='pvalue'</span></code> prediction will result in significantly longer processing time, altough it is more accurate! <code class="docutils literal notranslate"><span class="pre">predict_k_method='WH_sill'</span></code>, on the other hand, will be much faster.</p>
</div>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, shows progress in each k. The default is True.</p>
</dd>
<dt>nmf_verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, shows progress in each NMF operation. The default is False.</p>
</dd>
<dt>perturb_verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, it shows progress in each perturbation. The default is False.</p>
</dd>
<dt>transpose<span class="classifier">bool, optional</span></dt><dd><p>If True, transposes the input matrix before factorization. The default is False.</p>
</dd>
<dt>sill_thresh<span class="classifier">float, optional</span></dt><dd><p>Threshold for the Silhouette score when performing automatic prediction of the number of latent factors. The default is 0.8.</p>
</dd>
<dt>nmf_func<span class="classifier">object, optional</span></dt><dd><p>If not None, and if <code class="docutils literal notranslate"><span class="pre">nmf_method=func</span></code>, used for passing NMF function. The default is None.</p>
</dd>
<dt>nmf_method<span class="classifier">str, optional</span></dt><dd><p>What NMF to use. The default is “nmf_fro_mu”.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nmf_method='nmf_fro_mu'</span></code> will use NMF with Frobenious Norm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nmf_method='nmf_kl_mu'</span></code> will use NMF with Multiplicative Update rules with KL-Divergence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nmf_method='func'</span></code> will use the custom NMF function passed using the <code class="docutils literal notranslate"><span class="pre">nmf_func</span></code> parameter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nmf_method='nmf_recommender'</span></code> will use the Recommender NMF method for collaborative filtering.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nmf_method='wnmf'</span></code> will use the Weighted NMF for missing value completion.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nmf_method='bnmf'</span></code> will use the Boolean NMF for missing value completion on boolean matrix.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">nmf_method='nmf_recommender'</span></code>, RNMFk prediction method can be done using <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">TELF.factorization</span> <span class="pre">import</span> <span class="pre">RNMFk_predict</span></code>.</p>
<p>Here <code class="docutils literal notranslate"><span class="pre">RNMFk_predict(W,</span> <span class="pre">H,</span> <span class="pre">global_mean,</span> <span class="pre">bu,</span> <span class="pre">bi,</span> <span class="pre">u,</span> <span class="pre">i)</span></code>, <code class="docutils literal notranslate"><span class="pre">W</span></code> and <code class="docutils literal notranslate"><span class="pre">H</span></code> are the latent factors, <code class="docutils literal notranslate"><span class="pre">global_mean</span></code>, <code class="docutils literal notranslate"><span class="pre">bu</span></code>, and <code class="docutils literal notranslate"><span class="pre">bi</span></code> are the biases returned from <code class="docutils literal notranslate"><span class="pre">nmf_recommender</span></code> method.</p>
<p>Finally, <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">i</span></code> are the indices to perform prediction on.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">nmf_method='wnmf'</span></code>, pass <code class="docutils literal notranslate"><span class="pre">nmf_obj_params={&quot;WEIGHTS&quot;:P}</span></code> where <code class="docutils literal notranslate"><span class="pre">P</span></code> is a matrix of size <code class="docutils literal notranslate"><span class="pre">X</span></code> and carries the weights for each item in <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
<p>For example, here <code class="docutils literal notranslate"><span class="pre">P</span></code> can be used as a mask where 1s in <code class="docutils literal notranslate"><span class="pre">P</span></code> are the known entries, and 0s are the missing values in <code class="docutils literal notranslate"><span class="pre">X</span></code> that we want to predict (i.e. a recommender system).</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">nmf_method='wnmf'</span></code> does not support sparse matrices currently.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">nmf_method='bnmf'</span></code>, pass <code class="docutils literal notranslate"><span class="pre">nmf_obj_params={&quot;MASK&quot;:P}</span></code> where <code class="docutils literal notranslate"><span class="pre">P</span></code> is a mask matrix of size <code class="docutils literal notranslate"><span class="pre">X</span></code> where 0s and 1s in <code class="docutils literal notranslate"><span class="pre">P</span></code> are the known and unknown locations in <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
<p>0s in <code class="docutils literal notranslate"><span class="pre">P</span></code> are the places we would like to predict.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">nmf_method='bnmf'</span></code> does not support sparse matrices currently.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">nmf_method='bnmf'</span></code>, <code class="docutils literal notranslate"><span class="pre">perturb_type='bool'</span></code> or <code class="docutils literal notranslate"><span class="pre">perturb_type='boolean'</span></code> is recommended to use. It will not set it automatically but raise warning if not used.</p>
</div>
</dd>
<dt>clustering_method<span class="classifier">str, optional</span></dt><dd><p>Clustering used on the W patterns. Default is “kmeans”.
Options are “kmeans” and “bool” or “boolean”</p>
</dd>
<dt>nmf_obj_params<span class="classifier">dict, optional</span></dt><dd><p>Parameters used by NMF function. The default is {}.</p>
</dd>
<dt>clustering_obj_params: dict, optinal</dt><dd><p>Parameters used by custom clustering functions. The default is {}.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">nmf_method='bnmf'</span></code>, <code class="docutils literal notranslate"><span class="pre">max_iters:int</span></code> and <code class="docutils literal notranslate"><span class="pre">distance:str</span></code> can be passed here. <code class="docutils literal notranslate"><span class="pre">distance</span></code> can be <code class="docutils literal notranslate"><span class="pre">'hamming'</span></code>, <code class="docutils literal notranslate"><span class="pre">'FN'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'FP'</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">hamming</span></code>.</p>
<p>For all nmf methods passed in <code class="docutils literal notranslate"><span class="pre">nmf_method</span></code>, <code class="docutils literal notranslate"><span class="pre">max_iters</span></code> can also be passed.</p>
</dd>
<dt>pruned<span class="classifier">bool, optional</span></dt><dd><p>When True, removes columns and rows from the input matrix that has only 0 values. The default is True.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>If after pruning decomposition is not possible (for example if the number of samples left is 1, or K range is empty based on the rule <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">&lt;</span> <span class="pre">min(X.shape)</span></code>, <code class="docutils literal notranslate"><span class="pre">fit()</span></code> will return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</div>
</dd>
<dt>calculate_error<span class="classifier">bool, optional</span></dt><dd><p>When True, calculates the relative reconstruction error. The default is True.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="docutils literal notranslate"><span class="pre">calculate_error=True</span></code>, it will result in longer processing time.</p>
</div>
</dd>
<dt>perturb_multiprocessing<span class="classifier">bool, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">perturb_multiprocessing=True</span></code>, it will make parallel computation over each perturbation. Default is <code class="docutils literal notranslate"><span class="pre">perturb_multiprocessing=False</span></code>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">perturb_multiprocessing=False</span></code>, which is default, parallelization is done over each K (rank).</p>
</dd>
<dt>consensus_mat<span class="classifier">bool, optional</span></dt><dd><p>When True, computes the Consensus Matrices for each k. The default is False.</p>
</dd>
<dt>use_consensus_stopping<span class="classifier">str, optional</span></dt><dd><p>When not 0, uses Consensus matrices criteria for early stopping of NMF factorization. The default is 0.</p>
</dd>
<dt>mask<span class="classifier"><code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, optional</span></dt><dd><p>Numpy array that points out the locations in input matrix that should be masked during factorization. The default is None.</p>
</dd>
<dt>calculate_pac<span class="classifier">bool, optional</span></dt><dd><p>When True, calculates the PAC score for H matrix stability. The default is False.</p>
</dd>
<dt>get_plot_data<span class="classifier">bool, optional</span></dt><dd><p>When True, collectes the data used in plotting each intermidiate k factorization. The default is False.</p>
</dd>
<dt>simple_plot<span class="classifier">bool, optional</span></dt><dd><p>When True, creates a simple plot for each intermidiate k factorization which hides the statistics such as average and maximum Silhouette scores. The default is True.</p>
</dd>
<dt>k_search_method<span class="classifier">str, optional</span></dt><dd><p>Which approach to use when searching for the rank or k. The default is “linear”.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k_search_method='linear'</span></code> will linearly visit each K given in <code class="docutils literal notranslate"><span class="pre">Ks</span></code> hyper-parameter of the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k_search_method='bst_post'</span></code> will perform post-order binary search. When an ideal rank is found, determined by the selected <code class="docutils literal notranslate"><span class="pre">predict_k_method</span></code>, all lower ranks are pruned from the search space.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k_search_method='bst_pre'</span></code> will perform pre-order binary search. When an ideal rank is found, determined by the selected <code class="docutils literal notranslate"><span class="pre">predict_k_method</span></code>, all lower ranks are pruned from the search space.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k_search_method='bst_in'</span></code> will perform in-order binary search. When an ideal rank is found, determined by the selected <code class="docutils literal notranslate"><span class="pre">predict_k_method</span></code>, all lower ranks are pruned from the search space.</p></li>
</ul>
</dd>
<dt>H_sill_thresh<span class="classifier">float, optional</span></dt><dd><p>Setting for removing higher ranks from the search space.</p>
<p>When searching for the optimal rank with binary search using <code class="docutils literal notranslate"><span class="pre">k_search='bst_post'</span></code> or <code class="docutils literal notranslate"><span class="pre">k_search='bst_pre'</span></code>, this hyper-parameter can be used to cut off higher ranks from search space.</p>
<p>The cut-off of higher ranks from the search space is based on threshold for H silhouette. When a H silhouette below <code class="docutils literal notranslate"><span class="pre">H_sill_thresh</span></code> is found for a given rank or K, all higher ranks are removed from the search space.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">H_sill_thresh=None</span></code>, it is not used. The default is None.</p>
</dd>
<dt>factor_thresholding<span class="classifier">str, optional</span></dt><dd><p>If not None, W and H factors are thresholded using a thresholding method specified to be boolean. Default is None.</p>
<p>Options are <code class="docutils literal notranslate"><span class="pre">WH_thresh</span></code> and <code class="docutils literal notranslate"><span class="pre">coord_desc_thresh</span></code> and <code class="docutils literal notranslate"><span class="pre">otsu_thresh</span></code> and <code class="docutils literal notranslate"><span class="pre">kmeans_thresh</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">nmf_method='bnmf'</span></code>, <code class="docutils literal notranslate"><span class="pre">factor_thresholding='otsu_thresh'</span></code> is used by default.</p>
</dd>
<dt>factor_thresholding_H_regression<span class="classifier">str, optional</span></dt><dd><p>If not None, H factor is thresholded using a thresholding method specified to be boolean. Default is None.</p>
<p>Options are <code class="docutils literal notranslate"><span class="pre">coord_desc_thresh</span></code>, <code class="docutils literal notranslate"><span class="pre">otsu_thresh</span></code>, and <code class="docutils literal notranslate"><span class="pre">kmeans_thresh</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">nmf_method='bnmf'</span></code>, <code class="docutils literal notranslate"><span class="pre">factor_thresholding='kmeans_thresh'</span></code> is used by default.</p>
</dd>
<dt>factor_thresholding_obj_params<span class="classifier">dict, optional</span></dt><dd><p>Extra settings used for the thresholding used in <code class="docutils literal notranslate"><span class="pre">factor_thresholding</span></code>. Default is {}.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">factor_thresholding='coord_desc_thresh'</span></code>, options include <code class="docutils literal notranslate"><span class="pre">max_iter:int</span></code>, <code class="docutils literal notranslate"><span class="pre">wt</span></code>, and <code class="docutils literal notranslate"><span class="pre">ht</span></code>.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">factor_thresholding='WH_thresh'</span></code>, options include <code class="docutils literal notranslate"><span class="pre">npoint</span></code>.</p>
</dd>
<dt>factor_thresholding_H_regression_obj_params<span class="classifier">dict, optional</span></dt><dd><p>Extra settings used for the thresholding used in <code class="docutils literal notranslate"><span class="pre">factor_thresholding_H_regression</span></code>. Default is {}.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">factor_thresholding='coord_desc_thresh'</span></code>, options include <code class="docutils literal notranslate"><span class="pre">max_iter:int</span></code>, <code class="docutils literal notranslate"><span class="pre">wt</span></code>, and <code class="docutils literal notranslate"><span class="pre">ht</span></code>.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">factor_thresholding='WH_thresh'</span></code>, options include <code class="docutils literal notranslate"><span class="pre">npoint</span></code>.</p>
</dd>
<dt>device<span class="classifier">int or list, optional</span></dt><dd><p>CUDA device or list of CUDA devices (GPUs) to use. Default is -1.</p>
<p>When device is a positive integer such as <code class="docutils literal notranslate"><span class="pre">device=0</span></code> it will use the given GPU with the id.</p>
<p>When device is -1, it will use all devices.</p>
<p>When device is a list of devices, it will use those devices.</p>
<p>If device is negative integer other than -1, it will use number if GPUs minues the device + 1.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="TELF.factorization.NMFk.NMFk.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NMFk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">note</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TELF/factorization/NMFk.html#NMFk.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TELF.factorization.NMFk.NMFk.fit" title="Link to this definition">#</a></dt>
<dd><p>Factorize the input matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> for the each given K value in <code class="docutils literal notranslate"><span class="pre">Ks</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> or <code class="docutils literal notranslate"><span class="pre">scipy.sparse._csr.csr_matrix</span></code> matrix) – Input matrix to be factorized.</p></li>
<li><p><strong>Ks</strong> (<em>list</em>) – <p>List of K values to factorize the input matrix.</p>
<p><strong>Example:</strong> <code class="docutils literal notranslate"><span class="pre">Ks=range(1,</span> <span class="pre">10,</span> <span class="pre">1)</span></code>.</p>
</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the experiment. Default is “NMFk”.</p></li>
<li><p><strong>note</strong> (<em>str</em><em>, </em><em>optional</em>) – Note for the experiment used in logs. Default is “”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>results</strong> – Resulting dict can include all the latent factors, plotting data, predicted latent factors, time took for factorization, and predicted k value depending on the settings specified.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">get_plot_data=True</span></code>, results will include field for <code class="docutils literal notranslate"><span class="pre">plot_data</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">predict_k=True</span></code>, results will include field for <code class="docutils literal notranslate"><span class="pre">k_predict</span></code>. This is an intiger for the automatically estimated number of latent factors.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">predict_k=True</span></code> and <code class="docutils literal notranslate"><span class="pre">collect_output=True</span></code>, results will include fields for <code class="docutils literal notranslate"><span class="pre">W</span></code> and <code class="docutils literal notranslate"><span class="pre">H</span></code> which are the latent factors in type of <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>.</p></li>
<li><p>results will always include a field for <code class="docutils literal notranslate"><span class="pre">time</span></code>, that gives the total compute time.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tensor Extraction of Latent Features (T-ELF)</p>
      </div>
    </a>
    <a class="right-next"
       href="HNMFk.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>TELF.factorization.HNMFk:</strong> Hierarchical Non-negative Matrix Factorization with Automatic Model Determination</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>TELF.factorization.NMFk:</strong> Non-negative Matrix Factorization with Automatic Model Determination</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#available-functions">Available Functions</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#module-TELF.factorization.NMFk">Module Contents</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#TELF.factorization.NMFk.NMFk"><code class="docutils literal notranslate"><span class="pre">NMFk</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#TELF.factorization.NMFk.NMFk.fit"><code class="docutils literal notranslate"><span class="pre">NMFk.fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Maksim E. Eren, Nicholas Solovyev, Ryan Barron, Manish Bhattarai, Ismael Boureima, Erik Skau, Kim Rasmussen, Boian S. Alexandrov
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022, LANL.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>